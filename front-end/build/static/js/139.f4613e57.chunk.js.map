{"version":3,"file":"static/js/139.f4613e57.chunk.js","mappings":"mSAeA,MAmLA,EAnLqBA,KACnB,MAAOC,EAAcC,IAAmBC,EAAAA,EAAAA,UAAS,KAC1CC,EAAsBC,IAA2BF,EAAAA,EAAAA,UAAS,KAC1DG,EAAaC,IAAkBJ,EAAAA,EAAAA,UAAS,IAExCK,EAAYC,IAAiBN,EAAAA,EAAAA,UAAS,IACvCO,GAAWC,EAAAA,EAAAA,OACX,QAAEC,IAAYC,EAAAA,EAAAA,KAAaC,GAAUA,EAAMC,QAC3C,GAAEC,IAAOC,EAAAA,EAAAA,GAAWC,aAAaC,QAAQ,UAEzCC,EAAgBC,UACpB,IACEX,GAASY,EAAAA,EAAAA,KAAW,IACpB,MAAMC,QAAaC,EAAAA,EAAAA,GACjB,yCAEFC,QAAQC,IAAIH,GAEZrB,EAAgBqB,GAChBlB,EAAwBkB,EAC1B,CAAE,MAAOI,GACPF,QAAQE,MAAM,+BAAgCA,GAC9CC,EAAAA,GAAMD,MAAM,0BACd,CAAC,QACCjB,GAASY,EAAAA,EAAAA,KAAW,GACtB,IAEFO,EAAAA,EAAAA,YAAU,KACRT,GAAe,GACd,KAMHS,EAAAA,EAAAA,YAAU,KACyBC,MAC/B,IAAKtB,EAEH,YADAH,EAAwBJ,GAI1B,MAAM8B,EAAW9B,EAAa+B,QAAOC,GACnCC,IAAOD,EAAYE,iBAAiBC,OAAO,gBAAkB5B,IAE/DH,EAAwB0B,EAAS,EAGnCD,EAA0B,GACzB,CAAC7B,EAAcO,IAElB,MAAM6B,EAAaC,KAAKC,KAAKnC,EAAqBoC,OA/ClC,GAiEVC,EAAwBrC,EAAqBsC,MAjEnC,GAkEbpC,EAAc,GAlED,EAmEdA,GAmCF,OACEqC,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,EACEC,EAAAA,EAAAA,KAACC,EAAAA,EAAM,IACNnC,GACCkC,EAAAA,EAAAA,KAACE,EAAAA,EAAO,KAERL,EAAAA,EAAAA,MAAA,WAASM,UAAU,0BAAyBJ,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,MAAIG,UAAU,eAAcJ,SAAC,uBAG7BF,EAAAA,EAAAA,MAAA,OAAKM,UAAU,eAAcJ,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,SAAOI,QAAQ,aAAYL,SAAC,iCAC5BC,EAAAA,EAAAA,KAAA,SACEK,KAAK,OACLF,UAAU,aACVjC,GAAG,aACHoC,MAAO5C,EACP6C,SA5FoBC,IAC9B7C,EAAc6C,EAAEC,OAAOH,MAAM,OA+FtBhD,EAAqBoC,OAAS,GAC7BG,EAAAA,EAAAA,MAAA,OAAKM,UAAU,eAAcJ,SAAA,EAC3BF,EAAAA,EAAAA,MAAA,SAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAAD,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,UACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,YACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,aACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,kBACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,eACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,sBACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,YACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,kBAGRC,EAAAA,EAAAA,KAAA,SAAAD,SACGJ,EAAsBe,KAAI,CAACvB,EAAawB,KACvCd,SAAAA,EAAAA,MAAA,MAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAAD,SA7IJ,GA6IUvC,EAAc,GAAemD,EAAQ,KAC3CX,EAAAA,EAAAA,KAAA,MAAAD,SAAK,GAAGZ,EAAYyB,mBACpBZ,EAAAA,EAAAA,KAAA,MAAAD,SAAK,GAAGZ,EAAY0B,oBACpBb,EAAAA,EAAAA,KAAA,MAAAD,SAAKZ,EAAY2B,mBACjBd,EAAAA,EAAAA,KAAA,MAAAD,SAAKZ,EAAY4B,YACjBf,EAAAA,EAAAA,KAAA,MAAAD,UAnDHiB,EAmDgB7B,EAAYE,gBAlD9B,IAAI4B,KAAKD,GAEKE,mBAAmB,QAD9B,CAAEC,KAAM,UAAWC,MAAO,OAAQC,IAAK,gBAkDrCrB,EAAAA,EAAAA,KAAA,MAAAD,SAAKZ,EAAYmC,UACjBtB,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAAA,UACEG,UAAU,4BACVoB,QAASA,IAjFLhD,WAK1B,GAJ2B,aAAvBY,EAAYmC,QACdxC,EAAAA,GAAMD,MAAM,+CAGa,aAAvBM,EAAYmC,OACd,UACQE,EAAAA,EAAMC,IACV,wCAAwCtC,EAAYjB,KACpD,CACEwD,QAAS,CACPC,cAAe,UAAUvD,aAAaC,QAAQ,cAIpDS,EAAAA,GAAM8C,QAAQ,uCACdtD,GACF,CAAE,MAAOO,GACPF,QAAQE,MAAM,gCAAiCA,GAC/CC,EAAAA,GAAMD,MAAM,oDAEd,CACF,EA2DqCgD,CAAoB1C,GACnC2C,SAAiC,cAAvB3C,EAAYmC,OAAuBvB,SAC9C,iBAbIZ,EAAY4C,KA7CtBf,KA+DA,UAGLhB,EAAAA,EAAAA,KAAA,OAAKG,UAAU,aAAYJ,SA5GdiC,MACvB,MAAMC,EAAQ,GACd,IAAK,IAAIC,EAAI,EAAGA,GAAK3C,EAAY2C,IAC/BD,EAAME,MACJnC,EAAAA,EAAAA,KAAA,UAAgBuB,QAASA,KAP7B9D,EAOoDyE,EAAG,EAAAnC,SAChDmC,GADUA,IAKjB,OAAOD,CAAK,EAmG2BD,SAG/BhC,EAAAA,EAAAA,KAACoC,EAAAA,EAAK,CAACC,QAAQ,+BAIrBrC,EAAAA,EAAAA,KAAA,OAAKG,UAAU,GAAGJ,UAChBC,EAAAA,EAAAA,KAACsC,EAAAA,EAAM,QAER,C","sources":["pages/Appointments.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Empty from \"../components/Empty\";\r\nimport Footer from \"../components/Footer\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport fetchData from \"../helper/apiCall\";\r\nimport { setLoading } from \"../redux/reducers/rootSlice.js\";\r\nimport Loading from \"../components/Loading\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from \"axios\";\r\nimport \"../styles/user.css\";\r\nimport \"../styles/appointments.css\"\r\nimport moment from \"moment\";\r\n\r\nconst Appointments = () => {\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [filteredAppointments, setFilteredAppointments] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const PerPage = 5;\r\n  const [searchDate, setSearchDate] = useState(\"\");\r\n  const dispatch = useDispatch();\r\n  const { loading } = useSelector((state) => state.root);\r\n  const { id } = jwt_decode(localStorage.getItem(\"token\"));\r\n\r\n  const getAllAppoint = async () => {\r\n    try {\r\n      dispatch(setLoading(true));\r\n      const temp = await fetchData(\r\n        `/Appointment/GetAppointmentsForDoctor`\r\n      );\r\n      console.log(temp);\r\n\r\n      setAppointments(temp);\r\n      setFilteredAppointments(temp);\r\n    } catch (error) {\r\n      console.error(\"Error fetching appointments:\", error);\r\n      toast.error(\"No Appointments Founded\");\r\n    } finally {\r\n      dispatch(setLoading(false)); // Ensure loading is set to false regardless of success or failure\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    getAllAppoint();\r\n  }, []);\r\n\r\n  const handleSearchDateChange = (e) => {\r\n    setSearchDate(e.target.value);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const filterAppointmentsByDate = () => {\r\n      if (!searchDate) {\r\n        setFilteredAppointments(appointments);\r\n        return;\r\n      }\r\n\r\n      const filtered = appointments.filter(appointment =>\r\n        moment(appointment.appointmentDate).format('YYYY-MM-DD') === searchDate\r\n      );\r\n      setFilteredAppointments(filtered);\r\n    };\r\n\r\n    filterAppointmentsByDate();\r\n  }, [appointments, searchDate]);\r\n\r\n  const totalPages = Math.ceil(filteredAppointments.length / PerPage);\r\n\r\n  const handlePageChange = (page) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  const renderPagination = () => {\r\n    const pages = [];\r\n    for (let i = 1; i <= totalPages; i++) {\r\n      pages.push(\r\n        <button key={i} onClick={() => handlePageChange(i)}>\r\n          {i}\r\n        </button>\r\n      );\r\n    }\r\n    return pages;\r\n  };\r\n\r\n  const paginatedAppointments = filteredAppointments.slice(\r\n    (currentPage - 1) * PerPage,\r\n    currentPage * PerPage\r\n  );\r\n\r\n  const completeAppointment = async (appointment) => {\r\n    if (appointment.status === 'Cancelld') {\r\n      toast.error(\"This appointment has been cancelled before!\"); // More informative message\r\n    }\r\n\r\n    if (appointment.status !== 'Cancelld') {\r\n      try {\r\n        await axios.put(\r\n          `Appointment/EditAppointmentStatus?id=${appointment.id}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n            },\r\n          }\r\n        );\r\n        toast.success(\"Appointment completed successfully.\");\r\n        getAllAppoint(); // Refetch appointments after completing one\r\n      } catch (error) {\r\n        console.error(\"Error completing appointment:\", error);\r\n        toast.error(\"Failed to complete appointment. Please try again.\");\r\n        // TODO: Add better error handling, e.g., show a more specific error message, maybe with details from error.response\r\n      }\r\n    }\r\n  };\r\n\r\n  const fixDate = (dateString) => {\r\n    const date = new Date(dateString);\r\n    const options = { year: 'numeric', month: 'long', day: 'numeric' };\r\n    const formattedDate = date.toLocaleDateString('en-US', options)\r\n    return formattedDate\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      {loading ? (\r\n        <Loading />\r\n      ) : (\r\n        <section className=\"container notif-section\">\r\n          <h2 className=\"page-heading\">Your Appointments</h2>\r\n\r\n          {/* Search Input */}\r\n          <div className=\"search-input\">\r\n            <label htmlFor=\"searchDate\">Search by Appointment Date:</label>\r\n            <input\r\n              type=\"date\"\r\n              className=\"form-input\"\r\n              id=\"searchDate\"\r\n              value={searchDate}\r\n              onChange={handleSearchDateChange}\r\n            />\r\n          </div>\r\n\r\n          {filteredAppointments.length > 0 ? (\r\n            <div className=\"appointments\">\r\n              <table>\r\n                <thead>\r\n                  <tr>\r\n                    <th>S.No</th>\r\n                    <th>P Name</th>\r\n                    <th>P Email</th>\r\n                    <th>P Mobile No.</th>\r\n                    <th>time Slot</th>\r\n                    <th>Appointment Date</th>\r\n                    <th>Status</th>\r\n                    <th>Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {paginatedAppointments.map((appointment, index) => (\r\n                    <tr key={appointment._id}>\r\n                      <td>{(currentPage - 1) * PerPage + index + 1}</td>\r\n                      <td>{`${appointment.patientNameIN}`}</td>\r\n                      <td>{`${appointment.patientEmailIN}`}</td>\r\n                      <td>{appointment.patientNumberIN}</td>\r\n                      <td>{appointment.timeSlot}</td>\r\n                      <td>{fixDate(appointment.appointmentDate)}</td>\r\n                      <td>{appointment.status}</td>\r\n                      <td>\r\n                        <button\r\n                          className=\"btn user-btn complete-btn\"\r\n                          onClick={() => completeAppointment(appointment)}\r\n                          disabled={appointment.status === \"Completed\"}\r\n                        >\r\n                          Complete\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              <div className=\"pagination\">{renderPagination()}</div>\r\n            </div>\r\n          ) : (\r\n            <Empty message=\"No appointments found.\" />\r\n          )}\r\n        </section>\r\n      )}\r\n      <div className=\"\" /* style={{position: \"fixed\", bottom: \"0\", width: \"100%\"}} */>\r\n        <Footer />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Appointments;"],"names":["Appointments","appointments","setAppointments","useState","filteredAppointments","setFilteredAppointments","currentPage","setCurrentPage","searchDate","setSearchDate","dispatch","useDispatch","loading","useSelector","state","root","id","jwt_decode","localStorage","getItem","getAllAppoint","async","setLoading","temp","fetchData","console","log","error","toast","useEffect","filterAppointmentsByDate","filtered","filter","appointment","moment","appointmentDate","format","totalPages","Math","ceil","length","paginatedAppointments","slice","_jsxs","_Fragment","children","_jsx","Navbar","Loading","className","htmlFor","type","value","onChange","e","target","map","index","patientNameIN","patientEmailIN","patientNumberIN","timeSlot","dateString","Date","toLocaleDateString","year","month","day","status","onClick","axios","put","headers","Authorization","success","completeAppointment","disabled","_id","renderPagination","pages","i","push","Empty","message","Footer"],"sourceRoot":""}